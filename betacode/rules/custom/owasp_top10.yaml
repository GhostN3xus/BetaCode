rules:
  - id: "owasp-a01-injection-sql-py"
    name: "SQL Injection (Python)"
    description: "Detects potential SQL Injection vulnerabilities in Python code."
    pattern: |
      (execute|cursor\.execute|executemany)\s*\(\s*f?["'].*\{.*\}
    pattern: '(execute|cursor\.execute|executemany)\s*\(\s*f?["\'].*\{.*\}'
    severity: "CRITICAL"
    language: "python"
    cwe: "CWE-89"
    owasp: "A03:2021-Injection"
    remediation: "Use parameterized queries or prepared statements."
    category: "security"
    tags: ["owasp", "injection", "sql"]

  - id: "owasp-a01-injection-cmd-py"
    name: "Command Injection (Python)"
    description: "Detects potential Command Injection vulnerabilities."
    pattern: |
      (os\.system|subprocess\.call|subprocess\.Popen)\s*\(\s*f?["'].*\{.*\}.*shell\s*=\s*True
    pattern: '(os\.system|subprocess\.call|subprocess\.Popen)\s*\(\s*f?["\'].*\{.*\}.*shell\s*=\s*True'
    severity: "CRITICAL"
    language: "python"
    cwe: "CWE-78"
    owasp: "A03:2021-Injection"
    remediation: "Avoid using shell=True. Use a list of arguments instead of a string."
    category: "security"
    tags: ["owasp", "injection", "command"]

  - id: "owasp-a02-broken-auth-hardcoded-py"
    name: "Hardcoded Credentials (Python)"
    description: "Detects hardcoded passwords or keys."
    pattern: |
      (?i)(password|secret|apikey|token)\s*=\s*["'][a-zA-Z0-9_\-]{8,}["']
    pattern: '(?i)(password|secret|apikey|token)\s*=\s*["\'][a-zA-Z0-9_\-]{8,}["\']'
    severity: "HIGH"
    language: "python"
    cwe: "CWE-798"
    owasp: "A07:2021-Identification and Authentication Failures"
    remediation: "Use environment variables or a secret management service."
    category: "security"
    tags: ["owasp", "auth", "credentials"]

  - id: "owasp-a01-injection-sql-js"
    name: "SQL Injection (JavaScript)"
    description: "Detects potential SQL Injection in Node.js."
    pattern: |
      query\s*\(\s*`.*\{.*\}`
    pattern: 'query\s*\(\s*`.*\{.*\}`'
    severity: "CRITICAL"
    language: "javascript"
    cwe: "CWE-89"
    owasp: "A03:2021-Injection"
    remediation: "Use parameterized queries."
    category: "security"
    tags: ["owasp", "injection", "sql"]

  - id: "owasp-a03-xss-js"
    name: "Cross-Site Scripting (XSS)"
    description: "Detects potential XSS via dangerouslySetInnerHTML or similar."
    pattern: |
      dangerouslySetInnerHTML|innerHTML\s*=
    pattern: 'dangerouslySetInnerHTML|innerHTML\s*='
    severity: "HIGH"
    language: "javascript"
    cwe: "CWE-79"
    owasp: "A03:2021-Injection"
    remediation: "Sanitize input or use safer alternatives like textContent."
    category: "security"
    tags: ["owasp", "xss"]

  - id: "owasp-a05-security-misconfig-debug-py"
    name: "Debug Mode Enabled (Django/Flask)"
    description: "Detects if debug mode is enabled in production configuration."
    pattern: |
      DEBUG\s*=\s*True
    pattern: 'DEBUG\s*=\s*True'
    severity: "MEDIUM"
    language: "python"
    cwe: "CWE-489"
    owasp: "A05:2021-Security Misconfiguration"
    remediation: "Ensure DEBUG is False in production."
    category: "security"
    tags: ["owasp", "configuration"]

  - id: "owasp-a07-auth-failure-weak-hash-py"
    name: "Weak Hashing Algorithm (Python)"
    description: "Detects use of weak hashing algorithms like MD5 or SHA1."
    pattern: |
      hashlib\.(md5|sha1)\(
    pattern: 'hashlib\.(md5|sha1)\('
    severity: "MEDIUM"
    language: "python"
    cwe: "CWE-328"
    owasp: "A02:2021-Cryptographic Failures"
    remediation: "Use stronger algorithms like SHA-256 or SHA-512."
    category: "security"
    tags: ["owasp", "crypto"]

  - id: "owasp-a04-insecure-design-pickle-py"
    name: "Insecure Deserialization (Pickle)"
    description: "Detects usage of pickle which is vulnerable to remote code execution."
    pattern: |
      pickle\.loads?\(
    pattern: 'pickle\.loads?\('
    severity: "CRITICAL"
    language: "python"
    cwe: "CWE-502"
    owasp: "A08:2021-Software and Data Integrity Failures"
    remediation: "Do not unpickle data from untrusted sources. Use JSON."
    category: "security"
    tags: ["owasp", "deserialization"]

  - id: "owasp-a01-injection-sql-java"
    name: "SQL Injection (Java)"
    description: "Detects potential SQL Injection in Java (JDBC)."
    pattern: |
      (createStatement|prepareStatement)\s*\(\s*["'].*\+\s*[a-zA-Z0-9_]+\s*\+
    pattern: '(createStatement|prepareStatement)\s*\(\s*["\'].*\+\s*[a-zA-Z0-9_]+\s*\+'
    severity: "CRITICAL"
    language: "java"
    cwe: "CWE-89"
    owasp: "A03:2021-Injection"
    remediation: "Use PreparedStatement with placeholders (?)."
    category: "security"
    tags: ["owasp", "injection", "sql"]

  - id: "owasp-a02-broken-auth-hardcoded-java"
    name: "Hardcoded Password (Java)"
    description: "Detects hardcoded passwords in Java strings."
    pattern: |
      (?i)(password|secret|key)\s*=\s*["'][a-zA-Z0-9_\-]{8,}["']
    pattern: '(?i)(password|secret|key)\s*=\s*["\'][a-zA-Z0-9_\-]{8,}["\']'
    severity: "HIGH"
    language: "java"
    cwe: "CWE-798"
    owasp: "A07:2021-Identification and Authentication Failures"
    remediation: "Use properties files or environment variables."
    category: "security"
    tags: ["owasp", "auth", "credentials"]
